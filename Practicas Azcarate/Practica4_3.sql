CREATE TABLE USUARIOS(
NUMTELEF NUMBER(9,0),
NIA NUMBER(6,0)NOT NULL,
NOMBRE VARCHAR(15),
FOTO LONG,
ESTADO VARCHAR(30) DEFAULT 'Disponible',
CONSTRAINT NIA_U UNIQUE (NIA),
CONSTRAINT COD_USUARIOS PRIMARY KEY (NUMTELEF),
CONSTRAINT CHEK_NUM CHECK (NUMTELEF LIKE '_________'));

CREATE TABLE CHAT(
CODIGO NUMBER(12),
NOMBRE VARCHAR(30) NOT NULL,
FOTO_CHAT LONG,
CONSTRAINT COD_CHAT PRIMARY KEY (CODIGO));

CREATE TABLE PARTICIPA(
USUARIO_PARTICIPA NUMBER(9,0),
CHAT_PARTICIPA NUMBER(12),
CONSTRAINT FK1 FOREIGN KEY(USUARIO_PARTICIPA) REFERENCES USUARIOS(NUMTELEF),
CONSTRAINT FK2 FOREIGN KEY(CHAT_PARTICIPA) REFERENCES CHAT(CODIGO),
CONSTRAINT COD_PART PRIMARY KEY (USUARIO_PARTICIPA ,CHAT_PARTICIPA ));

CREATE TABLE MENSAJE(
USUARIO_MENSAJE NUMBER(9,0),
CHAT_MENSAJE NUMBER(12),
MENSAJE LONG NOT NULL,
FECHA DATE DEFAULT SYSDATE,
CONSTRAINT FK3234 FOREIGN KEY(USUARIO_MENSAJE) REFERENCES USUARIOS(NUMTELEF),
CONSTRAINT FK4234 FOREIGN KEY(CHAT_MENSAJE) REFERENCES CHAT(CODIGO),
CONSTRAINT COD_PART2 PRIMARY KEY (USUARIO_MENSAJE,CHAT_MENSAJE,FECHA));


/*2 a*/
INSERT INTO USUARIOS  (NUMTELEF,NOMBRE,FOTO,ESTADO) VALUES ('646636636','Alberto','255,127,0','Buenisimo');
INSERT INTO USUARIOS  (NUMTELEF,NOMBRE,FOTO) VALUES ('69696969','Daya','251,123,1');

/*2 b*/
DELETE FROM USUARIOS
WHERE NUMTELEF LIKE 69696969;

/*2 c*/
DROP TABLE USUARIOS CASCADE CONSTRAINTS;
INSERT INTO USUARIOS  (NUMTELEF,NOMBRE,FOTO) VALUES ('12345678','Daya','251,123,1'); /*Violate constraints*/
INSERT INTO USUARIOS  (NUMTELEF,NOMBRE,FOTO,ESTADO) VALUES ('646636636','Alberto','255,127,0','Buenisimo');


/*3 a*/
DROP TABLE USUARIOS CASCADE CONSTRAINTS;

/*3 b*/
INSERT INTO USUARIOS  (NUMTELEF,NIA,NOMBRE,FOTO) VALUES ('123456678','1','Daya','251,123,1');
INSERT INTO USUARIOS  (NUMTELEF,NIA,NOMBRE,FOTO) VALUES ('123456678','2','Daya','251,123,1'); /*Violate constraints*/

/*4 a*/

DROP TABLE CHAT CASCADE CONSTRAINTS;
DROP TABLE MENSAJE CASCADE CONSTRAINTS;
DROP TABLE PARTICIPA CASCADE CONSTRAINTS;
DROP TABLE USUARIOS CASCADE CONSTRAINTS;

/*4 b*/

INSERT INTO USUARIOS  (NUMTELEF,NIA) VALUES ('555123123','1');
INSERT INTO USUARIOS  (NUMTELEF,NIA,NOMBRE,ESTADO) VALUES ('555111222','2','Irati','Ocupado');
INSERT INTO USUARIOS  (NUMTELEF,NIA,NOMBRE,FOTO,ESTADO) VALUES ('555666777','3','Martin','0,127,255','En clase');

/*4 c*/

INSERT INTO CHAT  (CODIGO,NOMBRE) VALUES ('1','Prueba chat directo');
INSERT INTO CHAT  (CODIGO,NOMBRE,FOTO_CHAT) VALUES ('2','Prueba chat de grupo','255,127,0');

/*4 d*/

INSERT INTO PARTICIPA  (USUARIO_PARTICIPA,CHAT_PARTICIPA) VALUES ('555123123','2');
INSERT INTO PARTICIPA  (USUARIO_PARTICIPA,CHAT_PARTICIPA) VALUES ('555111222','1');
INSERT INTO PARTICIPA  (USUARIO_PARTICIPA,CHAT_PARTICIPA) VALUES ('555111222','2');
INSERT INTO PARTICIPA  (USUARIO_PARTICIPA,CHAT_PARTICIPA) VALUES ('555666777','1');
INSERT INTO PARTICIPA  (USUARIO_PARTICIPA,CHAT_PARTICIPA) VALUES ('555666777','2');

/*4 e*/

INSERT INTO MENSAJE  (USUARIO_MENSAJE,CHAT_MENSAJE,MENSAJE) VALUES ('555111222','1', 'Hola chat directo soy Irati');
INSERT INTO MENSAJE  (USUARIO_MENSAJE,CHAT_MENSAJE,MENSAJE) VALUES ('555666777','1','Hola chat directo soy Martin');
INSERT INTO MENSAJE  (USUARIO_MENSAJE,CHAT_MENSAJE,MENSAJE) VALUES ('555123123','2','Hola chat grupo no tengo 
nombre');
INSERT INTO MENSAJE  (USUARIO_MENSAJE,CHAT_MENSAJE,MENSAJE) VALUES ('555123123','2','Hola chat grupo soy Irati');
INSERT INTO MENSAJE  (USUARIO_MENSAJE,CHAT_MENSAJE,MENSAJE) VALUES ('555111222','2','Hola chat grupo soy Martin' );

/*5*/

DELETE FROM USUARIOS;